


import React, { useState, useEffect, useRef } from 'react';
import Swal from 'sweetalert2';
import { useNavigate, useLocation } from "react-router-dom";
import "./styles/CardUserPersonal.css"
import QRGeneratorNew from '../../../QR';
import { toPng } from 'html-to-image';

import QRCode from 'qrcode.react';
import html2canvas from 'html2canvas';
import { useSpring, animated } from 'react-spring';

const WidgetPersonalInformation = (props) => {

    const { Nombre,
            Sexo,
            Fecha,
            Edad,
            Telefono,
            ID_user,
            ImageURL
        } = props;

    const fade = useSpring({ opacity: 1, from: { opacity: 0 } });

/*
    const [Nombre, setNombre] = useState("");
    const [Direccion, setDireccion] = useState("");
    const [Sexo, setSexo] = useState("");
    const [Fecha, setFecha] = useState("");
    const [Familiar, setFamiliar] = useState("");
    const [Edad, setEdad] = useState("");
    const [Telefono, setTelefono] = useState("");
    const ID_user = "sadad"
    const ImageURL ="https://scontent.fbjx1-1.fna.fbcdn.net/v/t39.30808-6/361244890_3228751760604739_6437972533790968361_n.jpg?_nc_cat=108&cb=99be929b-59f725be&ccb=1-7&_nc_sid=09cbfe&_nc_eui2=AeEuR0Wydv3DyV80zvV1CZ75V0CqCGxFihlXQKoIbEWKGWUYBdsw_Vak4xFpVqj2QuDAwg_0FVGQF2KJcGz0GIjz&_nc_ohc=eWSTSq3D4kkAX8UA6rr&_nc_ht=scontent.fbjx1-1.fna&oh=00_AfBZxa1ReVTOuTYMlsrhCv8JV6ht8ccAlEvWTNc8MJp57w&oe=64C4B6E8"
*/
    const [downloadUrl, setDownloadUrl] = useState("");
    const qrCodeRef = useRef(null);

    

    const handleGenerateQR = async () => {
        // Create a temporary canvas element
        const canvas = document.createElement('canvas');
    
        // Get the QRCode's size
        const qrCodeSize = qrCodeRef.current.offsetWidth;
    
        // Set the canvas size to match the QRCode size
        canvas.width = qrCodeSize;
        canvas.height = qrCodeSize;
    
        // Get the canvas context
        const context = canvas.getContext('2d');
    
        // Draw the QRCode on the canvas
        await html2canvas(qrCodeRef.current, { canvas });
    
        // Get the QRCode image data URL
        const qrCodeDataURL = canvas.toDataURL();
    
        // Create a temporary anchor element to initiate the download
        const downloadLink = document.createElement('a');
        downloadLink.href = qrCodeDataURL;
        downloadLink.download = ID_user+'.png';
    
        // Simulate a click on the anchor to trigger the download
        document.body.appendChild(downloadLink);
        downloadLink.click();
    
        document.body.removeChild(downloadLink);
      };

    useEffect(() => {
       /* setNombre("Jose Javier Gutierrez Ramirez");
        setDireccion("Madroño 128, Valle de león, 37140.");
        setSexo("Masculino");
        setFecha("12/03/2001");
        setFamiliar("Cesar Delgado Cardona");
        setEdad("23 años");
        setTelefono("4772284248");
*/

    }, []);


    return (
       
       
           
            <animated.div style={fade} id='card'>

                <img id='imageItem' src={ImageURL} />

                <h1 id='Nombre'>{Nombre}</h1>
                <div id='containerItemsInfo'>


                    <div id='contenedorItem'>
                        <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 0 26 26" fill="none">
                            <g clip-path="url(#clip0_639_49)">
                                <path d="M13 0C5.83158 0 0 5.83158 0 13C0 20.1684 5.83158 26 13 26C20.1684 26 26 20.1684 26 13C26 5.83158 20.1684 0 13 0ZM9.59508 19.5C8.81183 19.5 8.02533 19.2173 7.42842 18.6193L6.86292 17.9692C6.37975 17.4861 6.37975 16.7017 6.86292 16.2186L8.27342 15.1353C8.75658 14.6521 9.54092 14.6521 10.0241 15.1353L11.1822 16.0572C13.4257 15.2002 15.0811 13.6132 16.0572 11.1822L15.1353 10.0241C14.6521 9.54092 14.6521 8.75658 15.1353 8.27342L16.2186 6.86292C16.7017 6.37975 17.4861 6.37975 17.9692 6.86292L18.6193 7.42842C19.2173 8.02533 19.5 8.81183 19.5 9.59508C19.5 13.9284 13.6186 19.5 9.59508 19.5Z" fill="#888686" />
                            </g>
                            <defs>
                                <clipPath id="clip0_639_49">
                                    <rect width="26" height="26" fill="white" />
                                </clipPath>
                            </defs>
                        </svg>
                        <p id='textLabel'>{Telefono}</p>
                    </div>

                    <div id='contenedorItem'>
                        <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 0 26 26" fill="none">
                            <g clip-path="url(#clip0_639_67)">
                                <path d="M24.3753 16.7915C23.9443 16.7915 23.531 16.9627 23.2263 17.2675C22.9215 17.5722 22.7503 17.9855 22.7503 18.4165V20.0415C22.7503 20.7598 22.465 21.4487 21.9571 21.9566C21.4492 22.4645 20.7603 22.7498 20.042 22.7498H18.417C17.986 22.7498 17.5727 22.921 17.2679 23.2258C16.9632 23.5305 16.792 23.9439 16.792 24.3748C16.792 24.8058 16.9632 25.2191 17.2679 25.5239C17.5727 25.8286 17.986 25.9998 18.417 25.9998H20.042C21.6217 25.9981 23.1362 25.3698 24.2533 24.2528C25.3703 23.1357 25.9986 21.6212 26.0003 20.0415V18.4165C26.0003 17.9855 25.8291 17.5722 25.5244 17.2675C25.2196 16.9627 24.8063 16.7915 24.3753 16.7915Z" fill="#888686" />
                                <path d="M1.625 9.20833C2.05598 9.20833 2.4693 9.03713 2.77405 8.73238C3.0788 8.42764 3.25 8.01431 3.25 7.58333V5.95833C3.25 5.24004 3.53534 4.55116 4.04325 4.04325C4.55116 3.53534 5.24004 3.25 5.95833 3.25H7.58333C8.01431 3.25 8.42764 3.0788 8.73238 2.77405C9.03713 2.4693 9.20833 2.05598 9.20833 1.625C9.20833 1.19402 9.03713 0.780698 8.73238 0.475951C8.42764 0.171205 8.01431 0 7.58333 0L5.95833 0C4.37861 0.00172052 2.86409 0.630024 1.74706 1.74706C0.630024 2.86409 0.00172052 4.37861 0 5.95833L0 7.58333C0 8.01431 0.171205 8.42764 0.475951 8.73238C0.780698 9.03713 1.19402 9.20833 1.625 9.20833Z" fill="#888686" />
                                <path d="M7.58333 22.7498H5.95833C5.24004 22.7498 4.55116 22.4645 4.04325 21.9566C3.53534 21.4487 3.25 20.7598 3.25 20.0415V18.4165C3.25 17.9855 3.0788 17.5722 2.77405 17.2675C2.4693 16.9627 2.05598 16.7915 1.625 16.7915C1.19402 16.7915 0.780698 16.9627 0.475951 17.2675C0.171205 17.5722 0 17.9855 0 18.4165L0 20.0415C0.00172052 21.6212 0.630024 23.1357 1.74706 24.2528C2.86409 25.3698 4.37861 25.9981 5.95833 25.9998H7.58333C8.01431 25.9998 8.42764 25.8286 8.73238 25.5239C9.03713 25.2191 9.20833 24.8058 9.20833 24.3748C9.20833 23.9439 9.03713 23.5305 8.73238 23.2258C8.42764 22.921 8.01431 22.7498 7.58333 22.7498Z" fill="#888686" />
                                <path d="M20.042 0H18.417C17.986 0 17.5727 0.171205 17.2679 0.475951C16.9632 0.780698 16.792 1.19402 16.792 1.625C16.792 2.05598 16.9632 2.4693 17.2679 2.77405C17.5727 3.0788 17.986 3.25 18.417 3.25H20.042C20.7603 3.25 21.4492 3.53534 21.9571 4.04325C22.465 4.55116 22.7503 5.24004 22.7503 5.95833V7.58333C22.7503 8.01431 22.9215 8.42764 23.2263 8.73238C23.531 9.03713 23.9443 9.20833 24.3753 9.20833C24.8063 9.20833 25.2196 9.03713 25.5244 8.73238C25.8291 8.42764 26.0003 8.01431 26.0003 7.58333V5.95833C25.9986 4.37861 25.3703 2.86409 24.2533 1.74706C23.1362 0.630024 21.6217 0.00172052 20.042 0Z" fill="#888686" />
                                <path d="M12.9997 11.9168C15.0938 11.9168 16.7913 10.2192 16.7913 8.12516C16.7913 6.03108 15.0938 4.3335 12.9997 4.3335C10.9056 4.3335 9.20801 6.03108 9.20801 8.12516C9.20801 10.2192 10.9056 11.9168 12.9997 11.9168Z" fill="#888686" />
                                <path d="M6.61936 19.3353C6.59425 19.49 6.60326 19.6483 6.64575 19.7992C6.68824 19.9501 6.76319 20.0898 6.86535 20.2087C6.96751 20.3276 7.09441 20.4227 7.23718 20.4874C7.37994 20.5521 7.53512 20.5848 7.69186 20.5833H18.3085C18.4654 20.5851 18.6209 20.5527 18.7639 20.4881C18.9069 20.4235 19.0341 20.3285 19.1365 20.2096C19.2389 20.0906 19.314 19.9508 19.3567 19.7997C19.3993 19.6487 19.4083 19.4902 19.3832 19.3353C19.0956 17.854 18.3016 16.519 17.1374 15.5591C15.9732 14.5992 14.5113 14.0742 13.0024 14.0742C11.4934 14.0742 10.0315 14.5992 8.86733 15.5591C7.70312 16.519 6.90913 17.854 6.62152 19.3353H6.61936Z" fill="#888686" />
                            </g>
                            <defs>
                                <clipPath id="clip0_639_67">
                                    <rect width="26" height="26" fill="white" />
                                </clipPath>
                            </defs>
                        </svg>
                        <p id='textLabel'>{Sexo}</p>
                    </div>

                    <div id='contenedorItem'>
                        <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 0 26 26" fill="none">
                            <g clip-path="url(#clip0_639_53)">
                                <path d="M18.4167 16.7917C18.4167 17.6898 17.6898 18.4167 16.7917 18.4167H9.20833C8.31025 18.4167 7.58333 17.6898 7.58333 16.7917C7.58333 15.8936 8.31025 15.1667 9.20833 15.1667H16.7917C17.6898 15.1667 18.4167 15.8936 18.4167 16.7917ZM26 8.125V20.0417C26 23.3274 23.3274 26 20.0417 26H5.95833C2.67258 26 0 23.3274 0 20.0417V8.125C0 4.83925 2.67258 2.16667 5.95833 2.16667H6.5V1.625C6.5 0.726917 7.22692 0 8.125 0C9.02308 0 9.75 0.726917 9.75 1.625V2.16667H16.25V1.625C16.25 0.726917 16.9769 0 17.875 0C18.7731 0 19.5 0.726917 19.5 1.625V2.16667H20.0417C23.3274 2.16667 26 4.83925 26 8.125ZM22.75 20.0417V9.75H3.25V20.0417C3.25 21.5345 4.4655 22.75 5.95833 22.75H20.0417C21.5345 22.75 22.75 21.5345 22.75 20.0417Z" fill="#888686" />
                            </g>
                            <defs>
                                <clipPath id="clip0_639_53">
                                    <rect width="26" height="26" fill="white" />
                                </clipPath>
                            </defs>
                        </svg>
                        <p id='textLabel'>{Fecha}</p>
                    </div>

                    <div id='contenedorItem'>
                        <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 0 26 26" fill="none">
                            <g clip-path="url(#clip0_639_65)">
                                <path d="M26 23.8333H23.8333V13C23.8333 12.138 23.4909 11.3114 22.8814 10.7019C22.2719 10.0924 21.4453 9.75 20.5833 9.75H14.0833V6.27683C14.5775 6.06503 14.9987 5.71287 15.2947 5.26399C15.5907 4.81511 15.7484 4.28926 15.7484 3.75158C15.7484 2.23383 13 0 13 0C13 0 10.2516 2.23383 10.2516 3.75158C10.2516 4.28926 10.4093 4.81511 10.7053 5.26399C11.0013 5.71287 11.4225 6.06503 11.9167 6.27683V9.75H5.41667C4.55471 9.75 3.72806 10.0924 3.11857 10.7019C2.50908 11.3114 2.16667 12.138 2.16667 13V23.8333H0V26H26V23.8333ZM5.41667 11.9167H20.5833C20.8707 11.9167 21.1462 12.0308 21.3494 12.234C21.5525 12.4371 21.6667 12.7127 21.6667 13V16.2283C20.6527 16.12 20.0417 15.47 20.0417 15.1667H17.875C17.875 15.5383 17.1362 16.25 15.9792 16.25C14.7994 16.25 14.0833 15.4982 14.0833 15.1667H11.9167C11.9167 15.5383 11.1778 16.25 10.0208 16.25C8.84108 16.25 8.125 15.4982 8.125 15.1667H5.95833C5.95833 15.5079 5.33108 16.1287 4.33333 16.2294V13C4.33333 12.7127 4.44747 12.4371 4.65063 12.234C4.8538 12.0308 5.12935 11.9167 5.41667 11.9167ZM4.33333 18.3939C5.32859 18.3498 6.28109 17.9768 7.04167 17.3333C7.87731 18.0299 8.93001 18.4128 10.0179 18.4157C11.1058 18.4187 12.1606 18.0416 13 17.3496C13.8394 18.0416 14.8942 18.4187 15.9821 18.4157C17.07 18.4128 18.1227 18.0299 18.9583 17.3333C19.7191 17.9764 20.6715 18.349 21.6667 18.3928V23.8333H4.33333V18.3939Z" fill="#888686" />
                            </g>
                            <defs>
                                <clipPath id="clip0_639_65">
                                    <rect width="26" height="26" fill="white" />
                                </clipPath>
                            </defs>
                        </svg>
                        <p id='textLabel'>{Edad}</p>
                    </div>
                </div>
                
                <div id="QR"ref={qrCodeRef} style={{ display: 'flex'}}>
                    {/* The QRCode component */}
                    <QRCode value={ID_user} size={140} />
                </div>

                
                <button id='btnQR' onClick={handleGenerateQR} >
                    <div class="btn-content">
                        <label id='textButton'>Descargar QRCode   </label>
                        <svg id="iconButton" xmlns="http://www.w3.org/2000/svg" width="17" height="17" viewBox="0 0 17 17" fill="none">
                            <g clip-path="url(#clip0_639_86)">
                                <path d="M4.95833 0H2.83333C1.27075 0 0 1.27075 0 2.83333V4.95833C0 6.52092 1.27075 7.79167 2.83333 7.79167H4.95833C6.52092 7.79167 7.79167 6.52092 7.79167 4.95833V2.83333C7.79167 1.27075 6.52092 0 4.95833 0ZM6.375 4.95833C6.375 5.73962 5.73962 6.375 4.95833 6.375H2.83333C2.05204 6.375 1.41667 5.73962 1.41667 4.95833V2.83333C1.41667 2.05204 2.05204 1.41667 2.83333 1.41667H4.95833C5.73962 1.41667 6.375 2.05204 6.375 2.83333V4.95833ZM4.95833 3.54167V4.25C4.95833 4.641 4.641 4.95833 4.25 4.95833H3.54167C3.15067 4.95833 2.83333 4.641 2.83333 4.25V3.54167C2.83333 3.15067 3.15067 2.83333 3.54167 2.83333H4.25C4.641 2.83333 4.95833 3.15067 4.95833 3.54167ZM12.0417 7.79167H14.1667C15.7292 7.79167 17 6.52092 17 4.95833V2.83333C17 1.27075 15.7292 0 14.1667 0H12.0417C10.4791 0 9.20833 1.27075 9.20833 2.83333V4.95833C9.20833 6.52092 10.4791 7.79167 12.0417 7.79167ZM10.625 2.83333C10.625 2.05204 11.2604 1.41667 12.0417 1.41667H14.1667C14.948 1.41667 15.5833 2.05204 15.5833 2.83333V4.95833C15.5833 5.73962 14.948 6.375 14.1667 6.375H12.0417C11.2604 6.375 10.625 5.73962 10.625 4.95833V2.83333ZM12.0417 4.25V3.54167C12.0417 3.15067 12.359 2.83333 12.75 2.83333H13.4583C13.8493 2.83333 14.1667 3.15067 14.1667 3.54167V4.25C14.1667 4.641 13.8493 4.95833 13.4583 4.95833H12.75C12.359 4.95833 12.0417 4.641 12.0417 4.25ZM4.95833 9.20833H2.83333C1.27075 9.20833 0 10.4791 0 12.0417V14.1667C0 15.7292 1.27075 17 2.83333 17H4.95833C6.52092 17 7.79167 15.7292 7.79167 14.1667V12.0417C7.79167 10.4791 6.52092 9.20833 4.95833 9.20833ZM6.375 14.1667C6.375 14.948 5.73962 15.5833 4.95833 15.5833H2.83333C2.05204 15.5833 1.41667 14.948 1.41667 14.1667V12.0417C1.41667 11.2604 2.05204 10.625 2.83333 10.625H4.95833C5.73962 10.625 6.375 11.2604 6.375 12.0417V14.1667ZM4.95833 12.75V13.4583C4.95833 13.8493 4.641 14.1667 4.25 14.1667H3.54167C3.15067 14.1667 2.83333 13.8493 2.83333 13.4583V12.75C2.83333 12.359 3.15067 12.0417 3.54167 12.0417H4.25C4.641 12.0417 4.95833 12.359 4.95833 12.75ZM12.0417 10.2708V10.9792C12.0417 11.5657 11.5657 12.0417 10.9792 12.0417H10.2708C9.68433 12.0417 9.20833 11.5657 9.20833 10.9792V10.2708C9.20833 9.68433 9.68433 9.20833 10.2708 9.20833H10.9792C11.5657 9.20833 12.0417 9.68433 12.0417 10.2708ZM14.1667 13.1042C14.1667 13.6907 13.6907 14.1667 13.1042 14.1667C12.5177 14.1667 12.0417 13.6907 12.0417 13.1042C12.0417 12.5177 12.5177 12.0417 13.1042 12.0417C13.6907 12.0417 14.1667 12.5177 14.1667 13.1042ZM12.0417 15.2292V15.9375C12.0417 16.524 11.5657 17 10.9792 17H10.2708C9.68433 17 9.20833 16.524 9.20833 15.9375V15.2292C9.20833 14.6427 9.68433 14.1667 10.2708 14.1667H10.9792C11.5657 14.1667 12.0417 14.6427 12.0417 15.2292ZM17 10.2708V10.9792C17 11.5657 16.524 12.0417 15.9375 12.0417H15.2292C14.6427 12.0417 14.1667 11.5657 14.1667 10.9792V10.2708C14.1667 9.68433 14.6427 9.20833 15.2292 9.20833H15.9375C16.524 9.20833 17 9.68433 17 10.2708Z" fill="white" />
                            </g>
                            <defs>
                                <clipPath id="clip0_639_86">
                                    <rect width="17" height="17" fill="white" />
                                </clipPath>
                            </defs>
                        </svg>
                    </div>
                </button>

                
            
                </animated.div>
       
    );
};

export default WidgetPersonalInformation;
